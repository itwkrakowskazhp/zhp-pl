import { Meta, Props, Story, Preview } from '@storybook/addon-docs/blocks';
import { withKnobs, text, object } from '@storybook/addon-knobs';
import { withA11y } from '@storybook/addon-a11y';
import axios from 'axios';
import ZPost from './ZPost.vue';

<Meta title="Molecules/Article" component={ZPost} decorators={[withKnobs, withA11y]}/>

# Article

<Preview>
  <Story name="Common">
    {{
        components: {ZPosts },
        props: {
          tag: {
            default: text('tag', 'div')
          },
          thumbnail: {
            default: text('thumbnail', 'https://demo.przemyslawspaczek.pl/wp-content/uploads/2020/08/fot.-ZHP-_-Karolina-Piotrowska-18.jpg')
          },
          title: {
            default: text('title', 'Nabór instruktorów do wydziałów i zespołów Głównej Kwatery ZHP: Podejmij służbę!')
          },
          author: {
            default: object('author', {value: 'Przemysław Spaczek', to: '#'})
          },
          date: {
            default: text('date', '2020-09-09T00:00:00')
          }
        },
        template: `<ZArticle
          :thumbnail="thumbnail"
          :title="title"
          to="https://zhp.pl"
          :author="author"
          :date="date"
          style="width: 250px"
        />`,
    }}
  </Story>
</Preview>

<Preview>
  <Story name="Grid">
    {{
        components: { ZPost },
        data() {
          return {
            posts: [],
          }
        },
        template: `<div style="display: grid; grid-template-columns: repeat(4, 1fr); column-gap: 20px; row-gap: 20px; max-width: 1071px; margin: 0 auto">
          <ZArticle
            v-for="(post, index) in posts"
            :key="post.id"
            :thumbnail="post.rest_media"
            :title="post.title.rendered"
            :to="post.link"
            author="Przemysław Spaczek"
            :sticky="post.sticky"
            :date="post.date"
            :class="{'z-post--highlighted': post.sticky, 'z-post--primary': index === 0}"
          />
        </div>`,
      async created(){
        const { API_URL } = process.env;
        const params = {
          per_page: 16,
        };
        const { data } = await axios.get(`${API_URL}/posts`, { params });
        this.posts = data;
      }
    }}
  </Story>
</Preview>

#Props

<Props of={ZPost} />
