name: zhp.pl docker image

on:
  push:
    branches: [master]
  pull_request:
    branches: [master]

jobs:
  build:
    name: Build
    runs-on: ubuntu-latest
    steps:
    - name: Set up Docker Buildx
      uses: docker/setup-buildx-action@v1

    - name: Build docker
      uses: docker/build-push-action@v2
      with:
        context: .
        push: false
        tags: zhp/zhp-pl:latest

    # - name: Upload package
    #   uses: actions/upload-artifact@v2
    #   with:
    #     name: App
    #     path: app

  # deploy:
  #   name: Deploy
  #   runs-on: ubuntu-latest
  #   if: success() && github.ref == 'refs/heads/master'
  #   needs: build
  #   steps:
  #   - name: Download package
  #     uses: actions/download-artifact@v2
  #     with:
  #       name: App

  #   - name: Login to Azure
  #     uses: azure/login@v1
  #     with:
  #       creds: ${{ secrets.AZURE_CREDENTIALS }}

  #   - name: Deploy ARM
  #     uses: azure/arm-deploy@v1
  #     with:
  #       deploymentMode: Complete
  #       subscriptionId: 69111246-db23-463c-82b2-7815ed5f8a1a
  #       resourceGroupName: office-accountmanagement
  #       template: deployment.arm.json
  #       parameters: JiraPassword=${{ secrets.JIRA_API_PASSWORD }} ActiveDirectoryCertBase64=${{ secrets.AAD_APP_CERTIFICATE }} ActiveDirectoryCertPassword=${{ secrets.AAD_APP_CERTIFICATE_PASSWORD }}

  #   - name: Upload files
  #     uses: Azure/functions-action@v1
  #     with:
  #       app-name: zhp-officeaccounts
  #       package: .
